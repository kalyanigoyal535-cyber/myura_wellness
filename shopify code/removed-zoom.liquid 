<div class="product-gallery">
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const thumbs = document.querySelectorAll(".product-thumbs .thumb");
      const mainImage = document.querySelector(".product-main-image img");

      thumbs.forEach(button => {
        button.addEventListener("click", function() {
          const largeUrl = this.getAttribute("data-large");
          const alt = this.querySelector("img").getAttribute("alt");

          mainImage.setAttribute("src", largeUrl);
          mainImage.setAttribute("alt", alt);

          // highlight active thumb
          thumbs.forEach(b => b.classList.remove("active"));
          this.classList.add("active");
        });
      });
    });
  </script>

  <style>
    /* Gallery layout */
    .product-gallery {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .product-main-image {
      flex: 1 1 65%;
      text-align: center;
    }
    .product-main-image img {
      max-width: 100%;
      height: auto;
    }
    .product-thumbs {
      flex: 0 0 120px;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    .product-thumbs .thumb {
      border: none;
      padding: 0;
      background: transparent;
      cursor: pointer;
    }
    .product-thumbs .thumb.active img {
      outline: 2px solid #000;
    }
    /* Mobile layout: thumbnails below main image */
    @media (max-width: 768px) {
      .product-gallery {
        flex-direction: column;
      }
      .product-thumbs {
        order: 2; /* below */
        flex-direction: row;
        justify-content: center;
        flex-wrap: wrap;
      }
      .product-thumbs .thumb img {
        width: 60px;
        height: 60px;
      }
      .product-main-image {
        order: 1;
      }
    }
  </style>

  <div class="product-main-image">
    {%- if product.featured_image -%}
      {%- assign featured_large = product.featured_image | img_url: '1024x1024' -%}
      <img
        id="main-product-image"
        src="{{ featured_large }}"
        width="1024"
        height="1024"
        alt="{{ product.title | escape }}"
        loading="eager"
        decoding="async"
      >
    {%- endif -%}
  </div>

  <div class="product-thumbs" role="tablist" aria-label="{{ 'products.product.media.thumbnails' | t }}">
    {%- for media in product.media -%}
      {%- if media.media_type == 'image' -%}
        {%- assign thumb_url = media | img_url: '200x200' -%}
        {%- assign large_url = media | img_url: '1024x1024' -%}
        <button
          type="button"
          class="thumb{% if forloop.first %} active{% endif %}"
          data-large="{{ large_url }}"
          aria-label="{{ 'products.product.media.load_image' | t: index: forloop.index }}"
        >
          <img
            src="{{ thumb_url }}"
            width="200"
            height="200"
            alt="{{ media.alt | escape }}"
            loading="lazy"
            decoding="async"
          >
        </button>
      {%- endif -%}
    {%- endfor -%}
  </div>
</div>
